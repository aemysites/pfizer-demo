/* eslint-disable */ 
import{FranklinBlock,createOptimizedPicture,loadScriptCustom,generateGifComponent,generateSharepointServedVideo}from"../../scripts/lib-franklin.js";export default class Video extends FranklinBlock{constructor(t,e,i){super(t,e,i),this.playerId="g2OtgoAoBs",this.defaultImage="/assets/video.png",this.playerSrc=t=>`https://players.brightcove.net/${t}/${this.playerId}_default/index.min.js`,this.getValue=t=>e=>[...e.children].find((e=>e.firstElementChild?.innerText.trim()===t))?.children[1]}variants=[{name:"gif",test:this.findSectionContent("gif")},{name:"local_served_video",test:this.findSectionContent("local_video")},{name:"no-poster",test:!this.block.querySelector("picture")},{name:"default",test:this.block.querySelector("playerId")}];readVideoData(){return this.block.children.length>0?[...this.block.children].reduce(((t,e)=>{if(2===e.children.length){const i=e.children[1].querySelector("picture source"),n=i?.srcset||void 0,o=e.children[1].querySelector("img"),a=o?.src||void 0;t[e.children[0].innerText.trim().toLowerCase()]=n||a||e.children[1].innerText.trim()}return t}),{}):{}}beforeBlockDataRead(){const t=this.findSectionContent("gif"),e=this.findSectionContent("local_video");t?(t.classList.add("video-gif-image"),t.querySelector("picture")?.classList.add("video-gif-image")):delete this.schema?.schema?.gif_image,e?e.classList.add("local-video"):delete this.schema?.schema?.localVideo,"no-poster"===this.variant&&(delete this.schema.schema?.poster,delete this.schema.schema?.posterImg)}beforeBlockRender(){const t="gif"!==this.variant,e=this.readVideoData(this.block);if(this.inputData={...e,player_id:this.playerId,...this.inputData,isVideo:t},this.inputData={...this.inputData,[this.variant]:{...this.inputData}},"true"!==this.inputData.autoplay?.toLowerCase()&&delete this.inputData.autoplay,"true"!==this.inputData.loop?.toLowerCase()&&delete this.inputData.loop,!(this.inputData.video_id&&this.inputData.account_id||"no-poster"!==this.variant&&"default"!==this.variant)){const t="Missing video data, video_id and account_id are required!";this.inputData.error=t,console.error(t)}if(!this.inputData.poster){this.inputData.posterImg||(this.inputData.posterImg=this.defaultImage);const t=createOptimizedPicture(this.inputData.posterImg);this.inputData.poster=t.outerHTML}return this.inputData.video_id&&this.inputData.account_id&&this.playerSrc(),this.inputData}afterBlockRender=()=>{this.block.classList.add("block-padding-standard");if((this.block.classList.contains("editorial-width")||this.block.classList.contains("inline"))&&this.block.classList.add("block-padding-desktop-x-190"),"gif"===this.variant){const t=this.block.querySelector(".video-container");return t.innerHTML="",generateGifComponent(this.inputData?.gif?.gif,this.inputData?.gif_static_image,t),!0}if("local_served_video"===this.variant){const t=this.block.querySelector(".video-container");return t.innerHTML="",generateSharepointServedVideo(this.inputData?.local_served_video?.local_video,t,!1,this.inputData.autoplay,this.inputData.loop),!0}if(this.inputData.video_id&&this.inputData.account_id){const t="fast"===this.inputData.load?.toLowerCase()?0:3e3;return setTimeout((async()=>{await loadScriptCustom(this.playerSrc(this.inputData.account_id));const t=this.block.querySelector("video-js"),e=bc(t),i=t.querySelector("video"),n=()=>{t.closest(".video-container")?.classList.add("loaded")};e.ready((()=>{i.readyState>0?n():e.on("loadedmetadata",n)})),e.on("play",(()=>{document.querySelectorAll("video").forEach((t=>{t!==i&&t.pause()}))}))}),t)}return!0}}export const schema='{\n  "video": {\n    "name": "video",\n    "description": "This is an Video block description",\n    "schema": {\n      "classes": ["inline", "sharepoint", "full-width", "left", "right", "embedded-content", "editorial-width", "no-gutter-block"],\n      "contentAtoms": true,\n      "poster": {\n        "selector": ":scope picture",\n        "target": "outerHtml",\n        "optional": true\n      },\n      "posterImg": {\n        "selector": ":scope picture img",\n        "target": "src",\n        "optional": true\n      },\n      "gif_image": {\n        "selector": ".video-gif-image",\n        "target": "innerHTML",\n        "optional": true\n      },\n      "local_video": {\n        "selector": ".local-video p",\n        "target": "textContent",\n        "optional": true\n      }\n    }\n  }\n}\n';export const template=' {{ #contentAtoms.headline }}\n  <div class="video-headline">\n    {{ contentAtoms.headline }}\n  </div>\n{{ /contentAtoms.headline }}\n\n<div class="video-container">\n  {{ #isVideo }}\n    {{ poster }}\n  {{ /isVideo }}\n\n  <video-js\n        id="{{ id }}"\n        data-account="{{ account_id }}"\n        data-player="{{ player_id }}"\n        data-video-id="{{ video_id }}"\n        data-embed="default"\n\n        {{ #loop }}\n          loop="true"\n        {{ /loop }}\n\n        preload="true"\n        class="vjs-fluid"\n\n        {{ #autoplay }}\n          autoplay\n          muted="true"\n        {{ /autoplay }}\n\n        poster="{{ posterImg }}"\n        {{ #title }}\n        title="{{ . }}"\n        {{ /title }}\n        controls\n    >\n    </video-js>\n    {{ #error }}\n    <div class="block-error">\n        <span class="icon icon-lib-mat-error-round"></span>\n        <div class="block-error-message">{{ . }}</div>\n    </div>\n    {{ /error }}\n</div>\n\n{{ #contentAtoms.content }}\n  <div class="bottom-atoms">\n    {{ contentAtoms.content }}\n  </div>\n{{ /contentAtoms.content }}\n\n\n{{ #contentAtoms.buttons }}\n  <div class="bottom-atoms">\n    {{ contentAtoms.buttons }}\n  </div>\n{{ /contentAtoms.buttons }}\n\n{{ #contentAtoms.disclaimer }}\n  <div class="bottom-atoms">\n    {{ contentAtoms.disclaimer }}\n  </div>\n{{ /contentAtoms.disclaimer }}\n';export const smartCaptureConfig=" {}";