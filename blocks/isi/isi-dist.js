/* eslint-disable */ 
import{FranklinBlock,overlayHostInstance,decorateButtons,decorateDefaultContent,throttle,platformFetchPage,platformOutputMarkupNew,decorateSections,decorateBlocks,loadBlocks,fetchPlaceholders}from"../../scripts/lib-franklin.js";const config=[{smName:"isi"},{selector:".toggle-isi",smName:"isi-open",event:"click"},{selector:".collapse-isi",smName:"isi-close",event:"click"}],getIsiContentHeight=(e=document)=>e.querySelector(".core-isi-content-container").scrollHeight+e.querySelector(".core-isi-header-container").offsetHeight,initializeIsi=(e=document)=>{const t=e.querySelector(".core-persistent-isi-container"),i=`${getIsiContentHeight(e)}px`;t.style.marginBottom=i},toggleExpanded=(e,t)=>{t.querySelector(".core-persistent-isi-container").classList.toggle("is-expanded",e),document.body.classList.toggle("disable-scroll",e);const i=t.querySelector(".toggle-isi"),n=t.querySelector(".collapse-isi");i?.toggleAttribute("aria-expanded",e),n?.toggleAttribute("aria-expanded",e),i.hasAttribute("aria-expanded")?i.setAttribute("data-smartcapture","isi-close"):i.setAttribute("data-smartcapture","isi-open");const s=t.querySelector(".core-isi-content-scroll-parent");s&&(s.scrollTop=0),initializeIsi()},togglePinned=([e],t)=>{const i=t.querySelector(".core-persistent-isi-container");i.classList.contains("is-expanded")||i.classList.toggle("is-pinned",!e.isIntersecting&&e.target.getBoundingClientRect().top>-1);!i.classList.contains("is-pinned")&&i.classList.contains("is-expanded")&&toggleExpanded(!1,t)},setAriaAttributes=async(e,t,i)=>{const{isiPartial:n,isiExpand:s,isiCollapse:o,isiExpanded:r}=await fetchPlaceholders(""),a=e.querySelector(".toggle-isi"),c=e.querySelector(".collapse-isi"),l=e.querySelector(".core-isi-block-container"),d=e.querySelector(".core-persistent-isi-container"),p=n,u=i?o:s;l.setAttribute("data-expanded",i),l.setAttribute("aria-label",`${t} - ${i?r:p}`),a&&(a.setAttribute("aria-controls","isi"),a.setAttribute("aria-label",`${u} ${t}`),a.toggleAttribute("disabled",!d.classList.contains("is-pinned"))),c&&(c.setAttribute("aria-controls","isi"),c.setAttribute("aria-label",`${o} ${t}`),c.toggleAttribute("disabled",!d.classList.contains("is-pinned")))},addEventListeners=(e,t)=>{const i=e.querySelector(".toggle-isi"),n=e.querySelector(".collapse-isi"),s=e.querySelector(".core-persistent-isi-container"),o=e.querySelector(".core-isi-title");setAriaAttributes(e,t,!1);const r=()=>{s.classList.add("was-expanded");const i=s.classList.contains("is-expanded");toggleExpanded(!i,e),setAriaAttributes(e,t,!i)};i?.addEventListener("click",r),o?.addEventListener("click",r),n?.addEventListener("click",(()=>{s.classList.contains("core-isi-two-buttons")&&s.classList.add("was-expanded"),toggleExpanded(!1,e),setAriaAttributes(e,t,!1)}));const a=new IntersectionObserver((i=>{togglePinned(i,e),setAriaAttributes(e,t,!s.classList.contains("is-pinned"))}),{threshold:0}),c=document.querySelector(".core-isi-intersection-test");c&&a.observe(c),window.addEventListener("keydown",(t=>{"Escape"===t.code&&s.classList.contains("is-expanded")&&toggleExpanded(!1,e)})),window.addEventListener("resize",throttle((()=>{toggleExpanded(!1,e),setAriaAttributes(e,t,!1)}),100))},addContentColumns=e=>{const t=e.querySelector(".core-isi-inside .section.break-after");if(t?.classList?.add("avoid-spacing"),!t)return;const i=e.querySelector(".core-isi-inside");i.classList.add("core-isi-inside-cols");const n=[...i.querySelectorAll(".section")];i.innerHTML='\n      <div class="col-one"></div>\n      <div class="col-two"></div>\n    ';const s=i.querySelector(".col-one"),o=i.querySelector(".col-two");let r=0;for(;r<n.length&&!n[r].classList.contains("break-after");)n[r]?.classList?.add("avoid-spacing"),s.append(n[r]),r+=1;for(s.append(t),r+=1;r<n.length;)n[r]?.classList?.add("avoid-spacing"),o.append(n[r]),r+=1};function showOverlay(e,t,i){const n=e.split(",");if(1===n.length)return void window.open(n[0],"_blank");const s=`<h5>${i}</h5>`,o=`\n    <div class="core-isi-overlay-info">${t}</div>\n    <div class="core-isi-overlay-links">${n.map((e=>`<a href="${e}" target="_blank">${e}</a>`)).join("")}</div>`;overlayHostInstance().setContentHTML({headlineHTML:s,bodyHTML:o}),overlayHostInstance().addCustomClass("core-isi-overlay"),overlayHostInstance().open()}const addContent=(e,{content:t,patientInfoLink:i,prescribingInfoLink:n,prescribingInfoText:s,patientInfoText:o})=>{if(e.querySelector(".core-isi-inside").append(t),addContentColumns(e),n||i){const t=e.querySelector(".core-isi-regulatory-links-container");let r="";n&&(r+=`<p><em><a href="${n} "data-link="${n}" data-info="${s}" class="core-isi-regulatory-link">Prescribing Information</a></em></p>`),i&&(r+=`<p><em><a href="${i}"data-link="${i}" data-info="${o}" class="core-isi-regulatory-link">Patient Information</a></em></p>`),t.innerHTML=r,e.querySelectorAll(".core-isi-regulatory-link").forEach((e=>e.addEventListener("click",(e=>{showOverlay(e.target.getAttribute("data-link"),e.target.getAttribute("data-info"),e.target.textContent)})))),decorateButtons(t)}else e.classList.add("core-isi-no-regulatory-links")},loadContent=async()=>{const e=await platformFetchPage("isi","/global/isi");if(!e)return null;const t=document.createElement("div");t.innerHTML=e;const i=t.querySelector("h1");i.parentElement.removeChild(i),decorateSections(t),decorateDefaultContent(t),decorateBlocks(t),await loadBlocks(t);const n=t.querySelector("[data-prescribing-information-links]")?.getAttribute("data-prescribing-information-links"),s=t.querySelector("[data-patient-information-links]")?.getAttribute("data-patient-information-links"),o=t.querySelector("[data-prescribing-information-text]")?.getAttribute("data-prescribing-information-text"),r=t.querySelector("[data-patient-information-text]")?.getAttribute("data-patient-information-text");return{title:i,content:t,patientInfoLink:s,prescribingInfoLink:n,prescribingInfoText:o,patientInfoText:r}};function setupScroll(e){let t;window.addEventListener("scroll",(()=>{e.querySelector(".core-persistent-isi-container").style.setProperty("--core-isi--collapsed-height-current",`${e.querySelector(".core-isi-header-container").offsetHeight+e.querySelector(".core-isi-regulatory-links-container").offsetHeight}px`),clearTimeout(t)}))}export default class Isi extends FranklinBlock{contentPromise;constructor(e,t){super(e,t),this.contentPromise=loadContent()}async beforeBlockRender(){const{isiFallbackTitle:e,isiCollapse:t,isiExpand:i}=await fetchPlaceholders("");this.inputData={isi:{expandText:i,collapseText:t,headerText:e,regulatoryLinks:[{href:"#",text:"Prescribing Information"},{href:"#",text:"Patient Information"}]}}}async afterBlockRender(){await platformOutputMarkupNew(this.block,(()=>this.block),config??void 0);const e=await this.contentPromise;addContent(this.block,e),this.block.querySelector(".core-isi-title").innerText=e.title?.innerText??this.inputData.isi.headerText;const t=e.title?.innerText;initializeIsi(this.block),addEventListeners(this.block,t??this.inputData.isi.headerText),setupScroll(this.block)}}export const schema='{\n  "isi": {\n    "name": "isi",\n    "description": "Important Safety Information block",\n    "schema": {\n      "classes": []\n    }\n  }\n}\n';export const template=' <div class="core-persistent-isi-container core-scrollbar" id="isi">\n  <aside class="core-isi-block-container">\n    <div class="core-isi-block-wrapper">\n      <div class="core-isi-regulatory-links">\n        <div class="core-isi-regulatory-links-container"></div>\n      </div>\n      <div class="core-isi-header-container">\n        <div class="core-isi-header">\n          <span class="core-isi-title"> {{ isi.headerText }}</span>\n          <div class="core-isi-buttons">\n            <button class="toggle-isi">\n              <span class="icon icon-lib-plus-circle expand"></span>\n              <span class="icon icon-lib-minus-circle collapse"></span>\n            </button>\n          </div>\n        </div>\n      </div>\n      <div class="core-isi-content-scroll-parent">\n        <div class="core-isi-content-container">\n          <div class="core-isi-content">\n            <div class="core-isi-inside block-inside">\n              \x3c!-- fragment goes here --\x3e\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </aside>\n  <div class="core-isi-intersection-test"></div>\n</div>\n';export const smartCaptureConfig=' {\n  "smartcapture": [\n    {\n      "smName": "isi"\n    },\n    {\n      "selector": ".toggle-isi",\n      "smName": "isi-open",\n      "event": "click"\n    }\n  ]\n}\n';